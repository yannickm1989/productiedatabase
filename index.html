<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Productiedatabase</title>

<script src="https://unpkg.com/tesseract.js@4/dist/tesseract.min.js"></script>

<style>
body { font-family: Arial; margin:0; }
header { background:#1976d2; color:white; padding:15px; font-size:20px; }
button { padding:12px; margin:5px; font-size:16px; }
.section { display:none; padding:15px; }
</style>
</head>

<body>

<header>Productiedatabase</header>

<div id="home">
<button onclick="showSection('invoer')">Invoer</button>
<button onclick="showSection('opzoeken')">Opzoeken</button>
</div>

<!-- INVOER -->
<div id="invoer" class="section">

<h3>Nieuwe invoer</h3>

<button onclick="startScan()">ðŸ“· Scan blad</button>
<input type="file" id="scanInput" accept="image/*" capture="environment" style="display:none">

<br><br>

<input id="product" placeholder="Product"><br>
<input id="kleur" placeholder="Kleur"><br>
<input id="batch" placeholder="Batch"><br>
<input id="operator" placeholder="Operator"><br>
<input id="datum" placeholder="Datum"><br>

<br>
<button onclick="saveData()">Opslaan</button>
<button onclick="showSection('home')">Terug</button>

</div>

<!-- OPZOEKEN -->
<div id="opzoeken" class="section">
<h3>Opzoeken</h3>
<button onclick="showSection('home')">Terug</button>
</div>

<script>

function showSection(id){
document.getElementById('home').style.display='none';
document.getElementById('invoer').style.display='none';
document.getElementById('opzoeken').style.display='none';

if(id==='home'){
document.getElementById('home').style.display='block';
}else{
document.getElementById(id).style.display='block';
}
}

// ===== SCAN =====
function startScan(){
document.getElementById('scanInput').click();
}

document.getElementById('scanInput').addEventListener('change', function(e){
const file = e.target.files[0];
if(!file) return;

Tesseract.recognize(file,'eng')
.then(result=>{
const text = result.data.text;

fillField('product', text);
fillField('kleur', text);
fillField('batch', text);
fillField('operator', text);
fillField('datum', text);

alert("Scan ingevuld âœ”");
});
});

function fillField(id,text){
const el=document.getElementById(id);
const label=el.placeholder.toLowerCase();

const lines=text.split('\n');
for(const line of lines){
if(line.toLowerCase().includes(label)){
el.value=line.split(':').pop().trim();
}
}
}

// ===== DUMMY SAVE =====
function saveData(){
alert("Opslaan (Firestore blijft jouw bestaande code)");
}

showSection('home');

</script>
</body>
</html>