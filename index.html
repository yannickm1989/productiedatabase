<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Productiedatabase</title>

<style>
body {
    font-family: Arial;
    background: #f5f5f5;
    padding: 20px;
}
.app {
    max-width: 450px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
label {
    font-weight: bold;
    margin-top: 10px;
    display: block;
}
input {
    width: 100%;
    padding: 8px;
    margin-top: 4px;
}
button {
    margin-top: 15px;
    padding: 10px;
    width: 100%;
    background: #28a745;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
}
.tab-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}
.tab-buttons button {
    flex: 1;
    background: #e0e0e0;
    color: #333;
}
.tab-buttons button.active {
    background: #28a745;
    color: white;
}
.title-bar {
    position: relative;
    text-align: center;
    background: #28a745;
    color: white;
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 15px;
}
.title-bar img {
    position: absolute;
    left: 10px;
    height: 40px;
    top: 50%;
    transform: translateY(-50%);
}
.result {
    border: 1px solid #ddd;
    padding: 10px;
    margin-top: 10px;
    border-radius: 8px;
}
.result button {
    width: auto;
    margin-right: 5px;
}
.delete {
    background: #dc3545;
}
.hidden {
    display: none;
}
</style>
</head>

<body>
<div class="app">

<div class="title-bar">
    <img src="ym.png">
    <h2>Productiedatabase</h2>
</div>

<div class="tab-buttons">
    <button id="tabInvoer" class="active">Invoer</button>
    <button id="tabZoek">Zoeken</button>
</div>

<!-- INVOER -->
<div id="invoer">
<label>Artikelnummer</label><input id="artikelnummer">
<label>Omschrijving</label><input id="omschrijving">
<label>Blikinhoud</label><input id="blikinhoud">
<label>Deksel</label><input id="deksel">
<label>Blik</label><input id="blik">
<label>Tray</label><input id="tray">
<label>Wrap</label><input id="wrap">
<label>Hoeveel per pak</label><input id="perPak">
<label>Per tray / doos</label><input id="perTray">
<label>Secundaire folie</label><input id="secFolie">
<label>Tertiaire folie</label><input id="terFolie">
<label>Tertiaire topfolie</label><input id="topFolie">
<label>Pallet</label><input id="pallet">
<label>Tussenlegger</label><input id="tussenlegger">
<label>Plaats tussenleggers</label><input id="plaatsTussenleggers">
<label>Stapelprogramma</label><input id="stapelprogramma">
<label>Aantal lagen</label><input id="aantalLagen">
<label>Hoeveel per laag</label><input id="perLaag">

<button onclick="opslaan()">Opslaan</button>
<div id="output"></div>
</div>

<!-- ZOEK -->
<div id="zoek" class="hidden">
<label>Zoek op artikelnummer of omschrijving</label>
<input id="zoekveld">
<button onclick="zoekArtikel()">Zoeken</button>
<div id="resultaten"></div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBtV-MNtSxf7mJ5RM5dS_5MeRdpcOMy6a4",
  authDomain: "productiedatabase.firebaseapp.com",
  projectId: "productiedatabase",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let editId = null;

const velden = [
 "artikelnummer","omschrijving","blikinhoud","deksel","blik","tray","wrap","perPak","perTray",
 "secFolie","terFolie","topFolie","pallet","tussenlegger","plaatsTussenleggers",
 "stapelprogramma","aantalLagen","perLaag"
];

velden.forEach(id=>{
 const el=document.getElementById(id);
 if(id!=="omschrijving"){
   el.addEventListener("input",()=>el.value=el.value.toUpperCase());
 }
});

window.opslaan = async ()=>{
 const data={};
 velden.forEach(id=>data[id]=document.getElementById(id).value);

 if(editId){
   await updateDoc(doc(db,"productie",editId),data);
   editId=null;
 } else {
   await addDoc(collection(db,"productie"),data);
 }

 velden.forEach(id=>document.getElementById(id).value="");
 output.innerText="Opgeslagen";
};

window.zoekArtikel = async ()=>{
 resultaten.innerHTML="";
 const term=zoekveld.value.toLowerCase();
 const snap=await getDocs(collection(db,"productie"));

 snap.forEach(d=>{
  const data=d.data();
  if(data.artikelnummer.toLowerCase().includes(term) ||
     data.omschrijving.toLowerCase().includes(term)){

    let html="<div class='result'>";
    velden.forEach(k=>{
      if(data[k]) html+=`<b>${k}:</b> ${data[k]}<br>`;
    });
    html+=`<button onclick="bewerk('${d.id}')">Bewerk</button>
           <button class="delete" onclick="verwijder('${d.id}')">Verwijder</button></div>`;
    resultaten.innerHTML+=html;
  }
 });
};

window.bewerk = async id=>{
 const snap=await getDocs(collection(db,"productie"));
 snap.forEach(d=>{
   if(d.id===id){
     const data=d.data();
     velden.forEach(k=>document.getElementById(k).value=data[k]||"");
     editId=id;
     tabInvoer.click();
   }
 });
};

window.verwijder = async id=>{
 if(confirm("Verwijderen?")){
   await deleteDoc(doc(db,"productie",id));
   zoekArtikel();
 }
};

tabInvoer.onclick=()=>{
 invoer.classList.remove("hidden");
 zoek.classList.add("hidden");
 tabInvoer.classList.add("active");
 tabZoek.classList.remove("active");
};
tabZoek.onclick=()=>{
 zoek.classList.remove("hidden");
 invoer.classList.add("hidden");
 tabZoek.classList.add("active");
 tabInvoer.classList.remove("active");
};
</script>
</body>
</html>
